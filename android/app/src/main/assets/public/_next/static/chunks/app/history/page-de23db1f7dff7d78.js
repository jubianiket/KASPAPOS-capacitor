(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[429],{14217:(e,r,t)=>{Promise.resolve().then(t.bind(t,81561))},22346:(e,r,t)=>{"use strict";t.d(r,{w:()=>l});var s=t(95155),a=t(12115),n=t(87489),i=t(59434);let l=a.forwardRef((e,r)=>{let{className:t,orientation:a="horizontal",decorative:l=!0,...o}=e;return(0,s.jsx)(n.b,{ref:r,decorative:l,orientation:a,className:(0,i.cn)("shrink-0 bg-border","horizontal"===a?"h-[1px] w-full":"h-full w-[1px]",t),...o})});l.displayName=n.b.displayName},26126:(e,r,t)=>{"use strict";t.d(r,{E:()=>l});var s=t(95155);t(12115);var a=t(74466),n=t(59434);let i=(0,a.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:r,variant:t,...a}=e;return(0,s.jsx)("div",{className:(0,n.cn)(i({variant:t}),r),...a})}},30285:(e,r,t)=>{"use strict";t.d(r,{$:()=>d,r:()=>o});var s=t(95155),a=t(12115),n=t(66634),i=t(74466),l=t(59434);let o=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef((e,r)=>{let{className:t,variant:a,size:i,asChild:d=!1,...c}=e,u=d?n.DX:"button";return(0,s.jsx)(u,{className:(0,l.cn)(o({variant:a,size:i,className:t})),ref:r,...c})});d.displayName="Button"},42099:(e,r,t)=>{"use strict";t.d(r,{EB:()=>m,Hh:()=>x,Jv:()=>g,NQ:()=>u,Xx:()=>b,ax:()=>d,fr:()=>p,gL:()=>i,ic:()=>l,kf:()=>c,mt:()=>h,o8:()=>f,q2:()=>o});let s=(0,t(72354).UU)("https://iwfunipsnoqfasntaofl.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml3ZnVuaXBzbm9xZmFzbnRhb2ZsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA2NzU1MjQsImV4cCI6MjA2NjI1MTUyNH0.E2YU0wDS16TUsIbX8qIM3Xo6XZF3Z_GuWFUmjWw7Z7A"),a=e=>{var r,t,s;return e?{id:e.id,created_at:e.date,items:Array.isArray(e.items)?e.items:[],subtotal:null!=(r=e.sub_total)?r:0,tax:null!=(t=e.gst)?t:0,total:null!=(s=e.total)?s:0,payment_method:e.payment_method,payment_status:e.payment_status,order_type:e.order_type,table_number:e.table_number,status:e.status,phone_no:e.phone_no,flat_no:e.flat_no,building_no:e.building_no,address:e.address,restaurant_id:e.restaurant_id}:e},n=e=>{var r;let t={date:e.created_at||new Date().toISOString(),items:e.items,sub_total:e.subtotal,gst:e.tax,total:e.total,order_type:e.order_type,table_number:e.table_number,payment_method:e.payment_method,payment_status:null!=(r=e.payment_status)?r:"unpaid",status:e.status,phone_no:e.phone_no,flat_no:e.flat_no,building_no:e.building_no,address:e.address,restaurant_id:e.restaurant_id};return e.id>0&&(t.id=e.id),t},i=async e=>{let{data:r,error:t}=await s.from("menu_items").select("*").eq("restaurant_id",e).order("name");return t?(console.error("Error fetching menu items:",t),[]):(r||[]).map(r=>({...r,rate:Number(r.rate),restaurant_id:e}))},l=async e=>{let{data:r,error:t}=await s.from("menu_items").insert(e).select().single();return t?(console.error("Error adding menu item:",t),null):r},o=async(e,r,t)=>{let{data:a,error:n}=await s.from("menu_items").update(t).match({id:e,restaurant_id:r}).select().single();return n?(console.error("Error updating menu item:",n),null):a},d=async(e,r)=>{let{error:t}=await s.from("menu_items").delete().match({id:e,restaurant_id:r});return!t||(console.error("Error deleting menu item:",t),!1)},c=async e=>{let{data:r,error:t}=await s.from("orders").select("*").eq("restaurant_id",e).neq("payment_status","paid").order("date",{ascending:!1});return t?(console.error("Error fetching active orders:",t),[]):r.map(a)},u=async e=>{let{data:r,error:t}=await s.from("orders").select("*").eq("restaurant_id",e).eq("payment_status","paid").order("date",{ascending:!1});return t?(console.error("Error fetching completed orders:",t),[]):r.map(a)},m=async e=>{if("pending"===e.status)return e;if(e.id<=0){let{id:r,...t}=n(e),{data:i,error:l}=await s.from("orders").insert(t).select().single();return l?(console.error("Error inserting order:",l),null):a(i)}{let r=n(e),{data:t,error:i}=await s.from("orders").update(r).match({id:e.id,restaurant_id:e.restaurant_id}).select().single();return i?(console.error("Error updating order:",i),null):a(t)}},f=async(e,r)=>{let{error:t}=await s.from("orders").delete().match({id:e,restaurant_id:r});return!t||(console.error("Error deleting order:",t),!1)},p=async e=>{if(!e.id||e.id<0)return console.error("Cannot create kitchen order without a valid main order ID."),null;let r={order_id:e.id,items:e.items,order_type:e.order_type,table_number:e.table_number,status:"preparing",restaurant_id:e.restaurant_id},{data:t,error:a}=await s.from("kitchen_orders").insert(r).select().single();return a?(console.error("Error creating kitchen order:",a),null):t},x=async(e,r,t)=>{let{data:a,error:n}=await s.from("users").select("id").or("email.eq.".concat(e,",username.eq.").concat(t.username)).maybeSingle();if(n&&"PGRST116"!==n.code)return console.error("Error checking for existing user:",n),null;if(a)return null;let{data:i,error:l}=await s.from("restaurants").insert({restaurant_name:"".concat(t.name,"'s Restaurant")}).select("id").single();if(l||!i)return console.error("Error creating restaurant:",l),null;let o={...t,email:e,password:r,role:"admin",restaurant_id:i.id},{data:d,error:c}=await s.from("users").insert(o).select().single();return c||!d?(console.error("Error creating user:",c),await s.from("restaurants").delete().eq("id",i.id),null):d},g=async(e,r)=>{let t=!isNaN(Number(e)),a="email.eq.".concat(e,",username.eq.").concat(e);t&&(a+=",phone.eq.".concat(Number(e)));let{data:n,error:i}=await s.from("users").select("*").or(a).single();if(i&&"PGRST116"!==i.code)return console.error("Error fetching user:",i),null;if(!n||n.password!==r)return null;let{data:l,error:o}=await s.from("users").select("*").eq("id",n.id).single();if(o||!l)return console.error("Could not re-fetch user after sign-in",o),null;let{password:d,...c}=l;return c},h=async e=>{let{data:r,error:t}=await s.from("restaurants").select("*").eq("id",e).maybeSingle();return t?(console.error("[getSettings] Error fetching settings:",t),null):r},b=async(e,r)=>{let{id:t,...a}=r,{data:n,error:i}=await s.from("restaurants").update(a).eq("id",e).select().single();return i?(console.error("[updateSettings] Error from Supabase:",i),null):n}},59434:(e,r,t)=>{"use strict";t.d(r,{cn:()=>n});var s=t(52596),a=t(39688);function n(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,a.QP)((0,s.$)(r))}},66695:(e,r,t)=>{"use strict";t.d(r,{BT:()=>d,Wu:()=>c,ZB:()=>o,Zp:()=>i,aR:()=>l,wL:()=>u});var s=t(95155),a=t(12115),n=t(59434);let i=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...a})});i.displayName="Card";let l=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",t),...a})});l.displayName="CardHeader";let o=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("h3",{ref:r,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",t),...a})});o.displayName="CardTitle";let d=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("p",{ref:r,className:(0,n.cn)("text-sm text-muted-foreground",t),...a})});d.displayName="CardDescription";let c=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,n.cn)("p-6 pt-0",t),...a})});c.displayName="CardContent";let u=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,n.cn)("flex items-center p-6 pt-0",t),...a})});u.displayName="CardFooter"},68856:(e,r,t)=>{"use strict";t.d(r,{E:()=>n});var s=t(95155),a=t(59434);function n(e){let{className:r,...t}=e;return(0,s.jsx)("div",{className:(0,a.cn)("animate-pulse rounded-md bg-muted",r),...t})}},81561:(e,r,t)=>{"use strict";t.d(r,{default:()=>w});var s=t(95155),a=t(12115),n=t(26126),i=t(51920),l=t(37648),o=t(15121),d=t(78071),c=t(79556),u=t(94394),m=t(22346),f=t(42099),p=t(68856),x=t(66695),g=t(27242);let h=g.bL,b=g.R6,y=g.Ke;var _=t(30285),j=t(59434),v=t(35695);function N(e){let{order:r}=e,[t,u]=(0,a.useState)(!1);return(0,s.jsxs)(x.Zp,{children:[(0,s.jsx)(x.aR,{className:"pb-4",children:(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)(x.ZB,{className:"text-lg",children:["Order #",r.id]}),(0,s.jsxs)("div",{className:"flex items-center gap-4 text-sm text-muted-foreground mt-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,s.jsx)(i.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:new Date(r.created_at).toLocaleDateString()})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,s.jsx)(l.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:new Date(r.created_at).toLocaleTimeString()})]})]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("p",{className:"font-bold text-lg text-primary",children:["Rs.",r.total.toFixed(2)]}),(0,s.jsx)(n.E,{variant:"Card"===r.payment_method?"default":"secondary",className:"capitalize mt-1",children:r.payment_method})]})]})}),(0,s.jsxs)(x.Wu,{className:"pt-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-4",children:["dine-in"===r.order_type?(0,s.jsx)(o.A,{className:"h-4 w-4"}):(0,s.jsx)(d.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"capitalize",children:r.order_type}),"dine-in"===r.order_type&&r.table_number&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.w,{orientation:"vertical",className:"h-4"}),(0,s.jsxs)("span",{children:["Table: ",(0,s.jsx)("span",{className:"font-semibold text-foreground",children:r.table_number})]})]})]}),(0,s.jsxs)(h,{open:t,onOpenChange:u,children:[(0,s.jsx)(y,{children:(0,s.jsxs)("div",{className:"py-4 bg-muted/50 rounded-md px-4 mt-2",children:[(0,s.jsx)("h4",{className:"font-semibold mb-2",children:"Order Details"}),(0,s.jsx)("ul",{className:"space-y-1 text-sm",children:r.items.map((e,r)=>(0,s.jsxs)("li",{className:"flex justify-between",children:[(0,s.jsxs)("span",{children:[e.name," ",(0,s.jsxs)("span",{className:"text-muted-foreground",children:["x ",e.quantity]})]}),(0,s.jsxs)("span",{children:["Rs.",(e.rate*e.quantity).toFixed(2)]})]},"".concat(e.id,"-").concat(r)))}),(0,s.jsx)("hr",{className:"my-2"}),(0,s.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Subtotal"}),(0,s.jsxs)("span",{children:["Rs.",r.subtotal.toFixed(2)]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Tax"}),(0,s.jsxs)("span",{children:["Rs.",r.tax.toFixed(2)]})]}),(0,s.jsxs)("div",{className:"flex justify-between font-bold",children:[(0,s.jsx)("span",{children:"Total"}),(0,s.jsxs)("span",{children:["Rs.",r.total.toFixed(2)]})]})]})]})}),(0,s.jsx)(x.wL,{className:"px-0 pb-0 pt-4",children:(0,s.jsx)(b,{asChild:!0,children:(0,s.jsxs)(_.$,{variant:"ghost",className:"w-full justify-center gap-2 text-sm",children:[t?"Hide":"View"," Details",(0,s.jsx)(c.A,{className:(0,j.cn)("h-4 w-4 transition-transform",t&&"rotate-180")})]})})})]})]})]})}function w(){let[e,r]=(0,a.useState)([]),[t,n]=(0,a.useState)(!0),i=(0,v.useRouter)();return((0,a.useEffect)(()=>{let e=async e=>{n(!0),r(await (0,f.NQ)(e)),n(!1)},t=localStorage.getItem("user");if(t){let r=JSON.parse(t);r.restaurant_id&&e(r.restaurant_id)}else i.replace("/login")},[i]),t)?(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:6}).map((e,r)=>(0,s.jsx)(p.E,{className:"h-56 w-full"},r))}):0===e.length?(0,s.jsxs)("div",{className:"text-center text-muted-foreground py-16 border-2 border-dashed rounded-lg",children:[(0,s.jsx)(u.A,{className:"mx-auto h-12 w-12"}),(0,s.jsx)("h3",{className:"mt-4 text-lg font-medium",children:"No Order History Found"}),(0,s.jsx)("p",{className:"mt-1 text-sm",children:"Completed orders will appear here."})]}):(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>(0,s.jsx)(N,{order:e},e.id))})}}},e=>{var r=r=>e(e.s=r);e.O(0,[908,43,441,684,358],()=>r(14217)),_N_E=e.O()}]);